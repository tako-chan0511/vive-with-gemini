---
title: 追加質問応答API（ask-follow-up）
description: 企業分析レポートに基づいて、ユーザーからの追加質問にAIがMarkdownで回答します。
---

# API仕様書：追加質問応答API

このAPIは、事前に提供された企業の分析レポートに基づき、ユーザーからの追加質問にAI（Gemini）を用いてMarkdown形式で回答する機能を提供します。

## エンドポイント

- **URL:** `/api/ask-follow-up`
- **メソッド:** `POST`

## リクエスト

### ボディ形式（JSON）

| パラメータ       | 型       | 必須 | 説明                         |
|------------------|----------|------|------------------------------|
| `analysisReport` | `string` | 必須 | 企業に関する分析レポート     |
| `question`       | `string` | 必須 | ユーザーからの追加質問       |

### 例:

```json
{
  "analysisReport": "2024年の売上成長率は前年比20%増加...",
  "question": "この企業の競合と比較して強みはどこにありますか？"
}
```

## レスポンス

### 成功時 (200 OK)

```json
{
  "answer": "## 比較分析\n\n| 項目 | 対象企業 | 競合企業A | 競合企業B |\n|---|---|---|---|\n| 成長率 | **20%** | 15% | 10% |\n..."
}
```

### 失敗時

- **400 Bad Request**: 入力パラメータが不足
- **405 Method Not Allowed**: POST以外のメソッド
- **500 Internal Server Error**: サーバー構成またはAI応答の問題

### エラー例:

```json
{
  "error": "分析レポートと質問の両方が必要です。"
}
```

## 特記事項

- **AIモデル**: `gemini-1.5-flash-latest`
- **構造化出力**: 見出し・太字・リスト・テーブルを含むMarkdown形式
- **CORS**: 対応状況不明（内部用途が想定される）

## APIキー

- `GEMINI_API_KEY` の設定が必要です。環境変数で指定してください。